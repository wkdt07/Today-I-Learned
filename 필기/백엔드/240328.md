# offline

### static -> 게시판 만들기



>settings에서 

```py
STATIC_URL = 'static/'

STATICFILES_DIRS = [
    BASE_DIR/'static',
]

# 이제 베이스 디렉토리에 templates 처럼 static 폴더 만들고 거기에 사진 넣으면 된다
```

이제 이미지 넣고 싶은 html 페이지에다가

> img src = '{%statce "sample_1.png"}' alt = "sample"> 넣으면 됨
>
> 물론 그 전에 load static 해야함


### ---------------------------------

> 고객이 서버로 미디어 넣는 방법

> settings에서

```py

MEDIA_URL = 'media/' # 미디어 파일의 접두사가 media

MEDIA_ROOT = BASE_DIR / 'media' # 업로드한 파일을 여기에 두겠다
```


> urls (*프로젝트*의 urls에 추가해야함)

```py
from django.contrib import admin
from django.urls import path,include

from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('articles/',include('articles.urls')),
] + static(settings.MEDIA_URL, document_root = settings.MEDIA_ROOT)

# URL 접두사를 MEDIA_URL을 받고 ('media/'), 이 파일들이 저장된 서버의 디렉토리 경로(MEDIA_ROOT)를 받는다

```

> models -> 모델에 추가
> 거기다가 pillow 도 pip 으로 추가해야함

```py
from django.db import models

# Create your models here.
class Article(models.Model):
    title = models.CharField(max_length = 20)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add = True)
    updated_at = models.DateTimeField(auto_now = True)
    image = models.ImageField(blank=True) # blank=True는 이미지 업로드 안 하고 데이터 추가했을 때 오류 방지용, img 가 비어있어도 된다.

```

> 이제 migrate 다시하기


> 그리고 이제 이걸 DB에 올릴 수 있도록 수정해야 함

1. html


```html
<!-- create.html -->
{% extends "base.html" %}

{% block content %}
<h1>NEW</h1>

<form action="{% url "articles:create" %}" method = "POST" enctype = "multipart/form-data"> 
    {% comment %}  enctype = "multipart/form-data" => 폼 데이터와 함께 파일(이미지, 문서 등)을 서버로 전송하기 위함 {% endcomment %}
```

2. views.py

```py
def create(request):
    if request.method == 'POST': 
        form  = ArticleForm(request.POST,request.FILES) #######!!!!!!!!!!!!!!!! 파일 받는걸 인자로 추가
     
        if form.is_valid():
            article = form.save()
            return redirect('articles:detail',article.pk)
    else: 
        form = ArticleForm() 
        
    
    context = {
        'form' : form,
    } 
    return render(request,'articles/create.html',context)
```

이러면 이제 db에 img가 같이 올라가고, media라는 디렉토리가 생성되면서 업로드 된다.


### -------------

> html에서 보이게 하려면?

```html

{% if article.image %} 
<img src="{{article.image.url}}" alt="img">
{% endif %}

<!-- {% comment %} {{article.image.url}} => 업로드 된 이미지의 url {% endcomment %}
{% comment %} 이미지가 존재할 때만 이미지를 띄울거다. 아니면 null값에서 오류남 {% endcomment %} -->

```


### 추가 자료

models에서 

```py
    image = models.ImageField(blank=True,upload_to='images/') # blank=True는 이미지 업로드 안 하고 데이터 추가했을 때 오류 방지용, img 가 비어있어도 된다.
    
    # upload_to='images/' -> 업로드된 이미지 파일들이 MEDIA_ROOT의 하위 디렉토리 'images/'에 저장
```

```py
    image = models.ImageField(blank=True,upload_to='%Y/%M/%d/')
    # 업로드 된 파일을 서버상에서 날짜별로 분류해서 저장해라
```